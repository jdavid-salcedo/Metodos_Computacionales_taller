<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-09-19 Sun 13:09 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Assignment02</title>
<meta name="author" content="Juan David Salcedo HernÃ¡ndez" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Assignment02</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4973fe4">1. First activity</a></li>
<li><a href="#org9c0966e">2. Second activity</a></li>
<li><a href="#org1354ebd">3. Third activity</a></li>
</ul>
</div>
</div>
<div class="org-src-container">
<pre class="src src-sh" id="orgb0257fb"><span style="color: #bd93f9;">echo</span> <span style="color: #f1fa8c;">"</span><span style="color: #8be9fd;">$</span><span style="color: #f1fa8c;">data</span><span style="color: #f1fa8c;">"</span> | sed s/<span style="color: #f1fa8c;">\^</span>:<span style="color: #f1fa8c;">\ \/</span>/g | <span style="color: #bd93f9;">grep</span> -v <span style="color: #f1fa8c;">"^$"</span> | sed s/<span style="color: #f1fa8c;">\'</span>//g
</pre>
</div>

<p>
We first import the necessary packages. Since we will plot some statistical data, the <code>seaborn</code> module will ease some steps:
</p>
<div class="org-src-container">
<pre class="src src-ipython">%config InlineBackend.figure_format = <span style="color: #f1fa8c;">'svg'</span>

<span style="color: #ff79c6;">import</span> pandas <span style="color: #ff79c6;">as</span> pd
<span style="color: #ff79c6;">from</span> tabulate <span style="color: #ff79c6;">import</span> tabulate
<span style="color: #ff79c6;">import</span> matplotlib.pyplot <span style="color: #ff79c6;">as</span> plt
<span style="color: #ff79c6;">import</span> seaborn <span style="color: #ff79c6;">as</span> sns
</pre>
</div>

<div id="outline-container-org4973fe4" class="outline-2">
<h2 id="org4973fe4"><span class="section-number-2">1</span> First activity</h2>
<div class="outline-text-2" id="text-1">
<p>
Firstly, we import the dataset and read it with Pandas.
</p>
<div class="org-src-container">
<pre class="src src-ipython">PATH_1 = <span style="color: #f1fa8c;">'~/Downloads/PS4_1.csv'</span>
dataFrame_1 = pd.read_csv(PATH_1)
tabulate(dataFrame_1.head(), headers=<span style="color: #f1fa8c;">'keys'</span>, tablefmt=<span style="color: #f1fa8c;">'orgtbl'</span>, showindex=<span style="color: #f1fa8c;">'always'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">Date</th>
<th scope="col" class="org-right">Unnamed: 1</th>
<th scope="col" class="org-right">Berri1</th>
<th scope="col" class="org-right">Maisonneuve<sub>1</sub></th>
<th scope="col" class="org-right">Maisonneuve<sub>2</sub></th>
<th scope="col" class="org-right">Brebeuf</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">01/01/2009</td>
<td class="org-right">0:00</td>
<td class="org-right">29</td>
<td class="org-right">20</td>
<td class="org-right">35</td>
<td class="org-right">nan</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">02/01/2009</td>
<td class="org-right">0:00</td>
<td class="org-right">19</td>
<td class="org-right">3</td>
<td class="org-right">22</td>
<td class="org-right">nan</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">03/01/2009</td>
<td class="org-right">0:00</td>
<td class="org-right">24</td>
<td class="org-right">12</td>
<td class="org-right">22</td>
<td class="org-right">nan</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">04/01/2009</td>
<td class="org-right">0:00</td>
<td class="org-right">24</td>
<td class="org-right">8</td>
<td class="org-right">15</td>
<td class="org-right">nan</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">05/01/2009</td>
<td class="org-right">0:00</td>
<td class="org-right">120</td>
<td class="org-right">111</td>
<td class="org-right">141</td>
<td class="org-right">nan</td>
</tr>
</tbody>
</table>

<p>
Notice that both &rsquo;Date&rsquo; and &rsquo;Unnamed: 1&rsquo; series can be disregarded, for there is no use case for them in what follows. To discard such values, we can use the method <code>.drop()</code>, on the data frame; we only need specify the keys of the columns that we wish to delete from the object by writing, in this particular case, the argument <code>columns=['Unnamed: 1', 'Date']</code>.
</p>
<div class="org-src-container">
<pre class="src src-ipython">dataFrame_1 = dataFrame_1.drop(columns=[<span style="color: #f1fa8c;">'Unnamed: 1'</span>, <span style="color: #f1fa8c;">'Date'</span>])
df = dataFrame_1.fillna(value=<span style="color: #f1fa8c;">'None'</span>)
tabulate(df.head(), headers=<span style="color: #f1fa8c;">'keys'</span>, tablefmt=<span style="color: #f1fa8c;">'orgtbl'</span>, showindex=<span style="color: #f1fa8c;">'always'</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Berri1</th>
<th scope="col" class="org-right">Maisonneuve<sub>1</sub></th>
<th scope="col" class="org-right">Maisonneuve<sub>2</sub></th>
<th scope="col" class="org-left">Brebeuf</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">29</td>
<td class="org-right">20</td>
<td class="org-right">35</td>
<td class="org-left">None</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">19</td>
<td class="org-right">3</td>
<td class="org-right">22</td>
<td class="org-left">None</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">24</td>
<td class="org-right">12</td>
<td class="org-right">22</td>
<td class="org-left">None</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">24</td>
<td class="org-right">8</td>
<td class="org-right">15</td>
<td class="org-left">None</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">120</td>
<td class="org-right">111</td>
<td class="org-right">141</td>
<td class="org-left">None</td>
</tr>
</tbody>
</table>

<p>
Now we wish to print out, on a dictionary, the following items:
</p>
<ul class="org-ul">
<li>Number of columns (otherwise known as &rsquo;series&rsquo;)</li>
<li>Name of each column</li>
<li>Nonempty registers per column</li>
<li>Memory usage for each column</li>
<li>Basic statistics for each column; mean, standard deviation, and maximum</li>
</ul>

<p>
The above is actually fairly straightforward on the account that Pandas provides us with tools for extracting such information. Indeed, the <code>.describe()</code> method yields a new data frame with, unsurprisingly, a set of values tying in with the descriptive statistics of the values on the original data frame; we thus need only extract some information from the <code>info</code> data frame, which we define to be the aforementioned set of statistical values. The number of columns is easily derived from the attribute <code>.columns</code>, whereas the memory usage can be queried by using the <code>.memory_usage()</code> method, which returns an object that we can then turn into a dictionary whose keys are the names of the columns in the first data set, and whose values are the memory spaces used by each series.
</p>

<p>
The remaining steps amount to basic manipulations of lists and dictionaries; there is nevertheless something that ought to be stated with clarity, and that is the usage of the <code>.loc[]</code> utility on the <code>info</code> data frame; its syntax is typically <code>.loc[num_row, key]</code>, in this case we do not use <code>num_row</code>, but rather an <i>index name</i>, which is the value we are looking for in the dataset: mean, std, etc.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">build_dict</span>(df) :
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">Variables and other dataframes to be recurrently used</span>
    info = df.describe()
    columns = df.columns
    memory = <span style="color: #ffb86c;">dict</span>(df.memory_usage())

    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">Assign values to be printed out on the dictionary</span>
    num_columns = <span style="color: #ffb86c;">len</span>(columns)
    names = <span style="color: #ffb86c;">list</span>(df.keys())
    nonempty_registers = {name: info.loc[<span style="color: #f1fa8c;">'count'</span>, name]
                          <span style="color: #ff79c6;">for</span> name <span style="color: #ff79c6;">in</span> columns}
    memory_usage = {name: memory[name]
                    <span style="color: #ff79c6;">for</span> name <span style="color: #ff79c6;">in</span> columns}
    stats = {name: {<span style="color: #f1fa8c;">'mean'</span>: info.loc[<span style="color: #f1fa8c;">'mean'</span>, name], <span style="color: #f1fa8c;">'std'</span>: info.loc[<span style="color: #f1fa8c;">'std'</span>, name], <span style="color: #f1fa8c;">'max'</span>: info.loc[<span style="color: #f1fa8c;">'max'</span>, name]}
             <span style="color: #ff79c6;">for</span> name <span style="color: #ff79c6;">in</span> columns}

    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">we finally define a dictionary with the corresponding values</span>
    dictionary = {<span style="color: #f1fa8c;">'cols'</span>: num_columns, <span style="color: #f1fa8c;">'keys'</span>: names, <span style="color: #f1fa8c;">'nonempty_registers'</span>: nonempty_registers, <span style="color: #f1fa8c;">'memory'</span>: memory_usage, <span style="color: #f1fa8c;">'stats'</span>: stats}
    <span style="color: #ff79c6;">return</span> dictionary

build_dict(dataFrame_1)
</pre>
</div>

<pre class="example" id="orgbb14d33">
  {'cols': 4,
  'keys': ['Berri1', 'Maisonneuve_1', 'Maisonneuve_2', 'Brebeuf'],
  'nonempty_registers': {'Berri1': 365.0,
  'Maisonneuve_1': 365.0,
  'Maisonneuve_2': 365.0,
  'Brebeuf': 178.0},
  'memory': {'Berri1': 2920,
  'Maisonneuve_1': 2920,
  'Maisonneuve_2': 2920,
  'Brebeuf': 2920},
  'stats': {'Berri1': {'mean': 2032.2,
  'std': 1878.8797986572208,
  'max': 6626.0},
  'Maisonneuve_1': {'mean': 1060.2520547945205,
  'std': 1079.5330858971347,
  'max': 4242.0},
  'Maisonneuve_2': {'mean': 2093.1698630136984,
  'std': 1854.3685230878293,
  'max': 6587.0},
  'Brebeuf': {'mean': 2576.3595505617977,
  'std': 2484.0047433344985,
  'max': 7575.0}}}
</pre>
</div>
</div>

<div id="outline-container-org9c0966e" class="outline-2">
<h2 id="org9c0966e"><span class="section-number-2">2</span> Second activity</h2>
<div class="outline-text-2" id="text-2">
<p>
We obviously need to read the <code>.csv</code> file with pandas.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #6272a4;"># </span><span style="color: #6272a4;">read the .csv file</span>
PATH_2 = <span style="color: #f1fa8c;">'~/Downloads/Crimes_-_2019.csv'</span>
dataFrame_2 = pd.read_csv(PATH_2)
</pre>
</div>

<p>
We can now clean the data set and proceed to plot it. The cleaning process defined in the <code>clean_1</code> routine is, essentially, not different from what we have done before: We disregard some series on our data set. In this case, however, what we need to ignore is but the majority of the series on the data frame; as such, the approach we take is to &rsquo;<i>select</i> rather than discard. And to select specific series, of course, there is a utility built-in to Pandas, namely the command <code>.loc[:, df.columns.intersection(['Date','Primary Type'])]</code>; this rather lengthy command can be translated into the following: localise all elements whose key is either <code>'Date'</code> or <code>'Primary Type'</code>, the row number does not matter. Finally, we select the <code>'Date'</code> seies, and format its contents with the command <code>pd.to_datetime()</code>, this command takes the series itself and some date format as an argument, and simply performs the conversion.
</p>

<p>
The <code>graph</code> routine requires some more work: we need to find a way of summing together every instance of the same crime: Namely, we use the <code>.groupby()</code> method on the original dataframe to perform a count over the <code>'Date'</code> series, that is, to find out how many times can we count a date which corresponds to a crime of some specific sort. There can be, for instance 10 dates associated with the crime &rsquo;Theft&rsquo;, and so the resulting data frame will have a row of the form | &rsquo;Theft&rsquo; | 10 |. This is precisely what it means for us to apply <code>.count()</code> over the series <code>'Date'</code>, grouping by <code>'Primary Type'</code>; we can then sort this data frame in descending order.
</p>

<p>
To finnish it all, we rename the columns and proceed to use seaborn to plot the information, as seen.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">clean_2</span>(df) :
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">eliminate the columns in which we are not interested</span>
    df = df.loc[:, df.columns.intersection([<span style="color: #f1fa8c;">'Date'</span>, <span style="color: #f1fa8c;">'Primary Type'</span>])]
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">properly format the dates</span>
    df[<span style="color: #f1fa8c;">'Date'</span>] = pd.to_datetime(df[<span style="color: #f1fa8c;">'Date'</span>], <span style="color: #ffb86c;">format</span>=<span style="color: #f1fa8c;">'%m/%d/%Y %I:%M:%S %p'</span>)

    <span style="color: #ff79c6;">return</span> df

<span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">graph</span>(df) :
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">group total crimes of the same sort</span>
    crimes_info = pd.DataFrame(df.groupby(by=<span style="color: #f1fa8c;">'Primary Type'</span>, as_index=<span style="color: #8be9fd;">False</span>)[<span style="color: #f1fa8c;">'Date'</span>].count().sort_values(by=<span style="color: #f1fa8c;">'Date'</span>,ascending=<span style="color: #8be9fd;">False</span>))
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">rename keys</span>
    crimes_info = crimes_info.rename(columns={<span style="color: #f1fa8c;">'Primary Type'</span>:<span style="color: #f1fa8c;">'Crime'</span>, <span style="color: #f1fa8c;">'Date'</span>:<span style="color: #f1fa8c;">'Count'</span>})

    plt.figure()
    chart = sns.barplot(x =<span style="color: #f1fa8c;">'Count'</span>, y=<span style="color: #f1fa8c;">'Crime'</span>, data=crimes_info, palette=<span style="color: #f1fa8c;">'Set1'</span>)
    chart.set_yticklabels(chart.get_yticklabels(), fontsize=<span style="color: #bd93f9; font-weight: bold;">8</span>)
    plt.show()

crimes = clean_2(dataFrame_2)
graph(crimes)
</pre>
</div>


<div id="org562b4e4" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/68CSXY.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>
</div>
</div>

<div id="outline-container-org1354ebd" class="outline-2">
<h2 id="org1354ebd"><span class="section-number-2">3</span> Third activity</h2>
<div class="outline-text-2" id="text-3">
<p>
Here we wish to analise some data about the Covid-19 pandemic in Latin America.
</p>
<div class="org-src-container">
<pre class="src src-ipython">PATH_3 = <span style="color: #f1fa8c;">'~/Downloads/country_vaccinations.csv'</span>
dataFrame_3 = pd.read_csv(PATH_3)
</pre>
</div>

<p>
To begin having a sense for what the data frame is, we can filter its contents in the sought of finding information about Colombia, which we can then import to a <code>.csv</code> file.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">filter_colombia</span>(df) :
    colombia_mask = df[<span style="color: #f1fa8c;">'country'</span>] == <span style="color: #f1fa8c;">'Colombia'</span>
    df = df[colombia_mask]
    df.to_csv(<span style="color: #f1fa8c;">'covid_colombia.csv'</span>, index=<span style="color: #8be9fd;">False</span>)

filter_colombia(dataFrame_3)
</pre>
</div>

<p>
We can define a list of latin-american countries, then we can search for instances of each country on the data frame.
</p>
<div class="org-src-container">
<pre class="src src-ipython">Latam = [<span style="color: #f1fa8c;">'Argentina'</span>, <span style="color: #f1fa8c;">'Bolivia'</span>, <span style="color: #f1fa8c;">'Brazil'</span>, <span style="color: #f1fa8c;">'Chile'</span>, <span style="color: #f1fa8c;">'Colombia'</span>, <span style="color: #f1fa8c;">'Costa rica'</span>, <span style="color: #f1fa8c;">'Cuba'</span>, <span style="color: #f1fa8c;">'Dominican Republic'</span>, <span style="color: #f1fa8c;">'Ecuador'</span>, <span style="color: #f1fa8c;">'El Salvador'</span>, <span style="color: #f1fa8c;">'Guatemala'</span>, <span style="color: #f1fa8c;">'Haiti'</span>, <span style="color: #f1fa8c;">'Honduras'</span>, <span style="color: #f1fa8c;">'Mexico'</span>, <span style="color: #f1fa8c;">'Nicaragua'</span>, <span style="color: #f1fa8c;">'Panama'</span>, <span style="color: #f1fa8c;">'Paraguay'</span>, <span style="color: #f1fa8c;">'Peru'</span>, <span style="color: #f1fa8c;">'Uruguay'</span>, <span style="color: #f1fa8c;">'Venezuela'</span>]
</pre>
</div>

<p>
Now we define a routine to make the comparison. To begin with, we filter information about counties appearing on the above list with the <code>filter_latam</code> routine. We can define a mask, here called <code>latam_mask</code> to yield a sub-set of the data set whose information corresponds to that of the latin american counties; the syntax is as follows: <code>df['country'].isin(Latam)</code>, which can be translated to the very simple condition &rsquo;return only the rows whose key value <code>country</code> is the name of some latin american country.&rsquo; All that is left is te effectively apply the mask on the data frame, select only the rows of our interest, and give it some format.
</p>

<p>
We perform the comparison in two different ways: First, by vaccinations per day; and second, by total amount of vaccinated people. As for the latter, we can explicitly define a new data frame with the <code>.groupby()</code> method. This time we are interested in grouping by country over the series <code>'total_vaccinations'</code>, from which we only need the maximum value (that is why we apply the <code>.max()</code> method); we sort the countries in descending order. With regards to to the first comparison task, it is far more easy to carry out, since the original data frame already provides us with the information we need, we just plot the value of <code>'total_vaccinations'</code> for each country in any given date.
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">filter_latam</span>(df) :
    latam_mask = df[<span style="color: #f1fa8c;">'country'</span>].isin(Latam)

    df = df[latam_mask]
    df = df.loc[:, df.columns.intersection([<span style="color: #f1fa8c;">'country'</span>, <span style="color: #f1fa8c;">'date'</span>, <span style="color: #f1fa8c;">'total_vaccinations'</span>])]
    df[<span style="color: #f1fa8c;">'date'</span>] = pd.to_datetime(df[<span style="color: #f1fa8c;">'date'</span>], <span style="color: #ffb86c;">format</span>=<span style="color: #f1fa8c;">'%Y-%m-%d'</span>)

    <span style="color: #ff79c6;">return</span> df

<span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">comparative</span>(df) :
    vaccinations = pd.DataFrame(df.groupby(by=<span style="color: #f1fa8c;">'country'</span>, as_index=<span style="color: #8be9fd;">False</span>)[<span style="color: #f1fa8c;">'total_vaccinations'</span>].<span style="color: #ffb86c;">max</span>().sort_values(by=<span style="color: #f1fa8c;">'total_vaccinations'</span>, ascending=<span style="color: #8be9fd;">False</span>))

    fig, ax = plt.subplots(<span style="color: #bd93f9; font-weight: bold;">2</span>, figsize=(<span style="color: #bd93f9; font-weight: bold;">15</span>,<span style="color: #bd93f9; font-weight: bold;">12</span>))
    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">Vaccinations per day</span>
    sns.scatterplot(ax=ax[<span style="color: #bd93f9; font-weight: bold;">0</span>], x=<span style="color: #f1fa8c;">'date'</span>, y=<span style="color: #f1fa8c;">'total_vaccinations'</span>, hue=<span style="color: #f1fa8c;">'country'</span>, data=df, palette=<span style="color: #f1fa8c;">'Set1'</span>)
    ax[<span style="color: #bd93f9; font-weight: bold;">0</span>].set_title(<span style="color: #f1fa8c;">'Vaccinations per day'</span>)
    ax[<span style="color: #bd93f9; font-weight: bold;">0</span>].grid(b=<span style="color: #8be9fd;">True</span>, which=<span style="color: #f1fa8c;">'major'</span>, color=<span style="color: #f1fa8c;">'#666666'</span>, linestyle=<span style="color: #f1fa8c;">'-'</span>, alpha=<span style="color: #bd93f9; font-weight: bold;">0.3</span>)

    <span style="color: #6272a4;"># </span><span style="color: #6272a4;">Total vaccinations</span>
    g = sns.barplot(ax=ax[<span style="color: #bd93f9; font-weight: bold;">1</span>], x =<span style="color: #f1fa8c;">'country'</span>, y=<span style="color: #f1fa8c;">'total_vaccinations'</span>, data=vaccinations, palette=<span style="color: #f1fa8c;">'Set1'</span>)
    g.set_xticklabels(g.get_xticklabels(),rotation=<span style="color: #bd93f9; font-weight: bold;">30</span>)
    ax[<span style="color: #bd93f9; font-weight: bold;">1</span>].set_title(<span style="color: #f1fa8c;">'Total vaccinations'</span>)
    ax[<span style="color: #bd93f9; font-weight: bold;">1</span>].grid(b=<span style="color: #8be9fd;">True</span>, which=<span style="color: #f1fa8c;">'major'</span>, color=<span style="color: #f1fa8c;">'#666666'</span>, linestyle=<span style="color: #f1fa8c;">'-'</span>, alpha=<span style="color: #bd93f9; font-weight: bold;">0.3</span>)
    plt.show()

<span style="color: #6272a4;"># </span><span style="color: #6272a4;">Driver code</span>
covid_in_latam = filter_latam(dataFrame_3)
comparative(covid_in_latam)
</pre>
</div>


<div id="orga1b9ede" class="figure">
<p><object type="image/svg+xml" data="./obipy-resources/V0Jy1c.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>

<p>
Finally, we can print a list of latin american countries which have vaccinated more than 2 million people:
</p>
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #ff79c6;">def</span> <span style="color: #50fa7b;">eval_interval</span>(df) :
    df = pd.DataFrame(df.groupby(by=<span style="color: #f1fa8c;">'country'</span>, as_index=<span style="color: #8be9fd;">False</span>)[<span style="color: #f1fa8c;">'total_vaccinations'</span>].<span style="color: #ffb86c;">max</span>().sort_values(by=<span style="color: #f1fa8c;">'total_vaccinations'</span>, ascending=<span style="color: #8be9fd;">False</span>))

    interval_mask = df[<span style="color: #f1fa8c;">'total_vaccinations'</span>].<span style="color: #ffb86c;">apply</span>(<span style="color: #ff79c6;">lambda</span> x : <span style="color: #bd93f9; font-weight: bold;">2</span>.0E6 &lt;= x)
    countries = pd.DataFrame(df[interval_mask])
    <span style="color: #ff79c6;">return</span> tabulate(countries, headers=<span style="color: #f1fa8c;">'keys'</span>, tablefmt=<span style="color: #f1fa8c;">'orgtbl'</span>, showindex=<span style="color: #f1fa8c;">'always'</span>)

eval_interval(covid_in_latam)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">country</th>
<th scope="col" class="org-right">total<sub>vaccinations</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">2</td>
<td class="org-left">Brazil</td>
<td class="org-right">2.09568e+07</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Chile</td>
<td class="org-right">1.07849e+07</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">Mexico</td>
<td class="org-right">8.98719e+06</td>
</tr>

<tr>
<td class="org-right">0</td>
<td class="org-left">Argentina</td>
<td class="org-right">4.1789e+06</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">Colombia</td>
<td class="org-right">2.33614e+06</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Juan David Salcedo HernÃ¡ndez</p>
<p class="date">Created: 2021-09-19 Sun 13:09</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.5)</p>
</div>
</body>
</html>
