#+TITLE: Assignment02

We first import the necessary packages
#+begin_src ipython :session mysession :exports both :results raw drawer
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
#+end_src

#+RESULTS:
:results:
# Out[3]:
:end:

* First activity
We then import the dataset and read it with Pandas
#+RESULTS:
:results:
# Out[1]:
:end:
#+begin_src ipython :session mysession :exports both :results raw drawer
PATH = '~/Downloads/PS4_1.csv'
data_frame = pd.read_csv(PATH)
#+end_src

#+RESULTS:
:results:
# Out[58]:
#+BEGIN_EXAMPLE
  Date Unnamed: 1  Berri1  Maisonneuve_1  Maisonneuve_2  Brebeuf
  0  01/01/2009       0:00      29             20             35      NaN
  1  02/01/2009       0:00      19              3             22      NaN
  2  03/01/2009       0:00      24             12             22      NaN
  3  04/01/2009       0:00      24              8             15      NaN
  4  05/01/2009       0:00     120            111            141      NaN
#+END_EXAMPLE
:end:

We eliminate both 'Date' and 'Unnamed: 1' series.
#+begin_src ipython :session mysession :exports both :results raw drawer
data_frame = data_frame.drop(columns=['Unnamed: 1', 'Date'])
data_frame
#+end_src

#+RESULTS:
:results:
# Out[15]:
#+BEGIN_EXAMPLE
  Berri1  Maisonneuve_1  Maisonneuve_2  Brebeuf
  0        29             20             35      NaN
  1        19              3             22      NaN
  2        24             12             22      NaN
  3        24              8             15      NaN
  4       120            111            141      NaN
  ..      ...            ...            ...      ...
  360      66             29             52      0.0
  361      61             41             99      0.0
  362      89             52            115      0.0
  363      76             43            115      0.0
  364      53             46            112      0.0

  [365 rows x 4 columns]
#+END_EXAMPLE
:end:

Now we wish to return, on a dictionary, the following items: ...

#+begin_src ipython :session mysession :exports both :results raw drawer
# Variables and other dataframes to be recurrently used
info = data_frame.describe()
columns = data_frame.columns
memory = data_frame.memory_usage()

num_colums = len(columns)
names = data_frame.keys()
nonempty_registers = [info.loc['count', name]
                      for name in columns]
# memory_usage = [[name, memory.loc[i, ]]]
stats = [[name, info.loc['mean', name], info.loc['std', name], info.loc['max', name]]
         for name in columns]

# we finally define a disctionary with the corresponding values
dictionary = {'cols': num_columns, 'names': names, 'nonempty_regs': nonempty_registers, 'stats': stats}
#+end_src

#+RESULTS:
:results:
# Out[36]:
:end:

* Second activity
#+begin_src ipython :session mysession :exports both :results raw drawer
%config InlineBackend.figure_format = 'svg'

# read the .csv file
PATH2 = '~/Downloads/Crimes_-_2019.csv'
df = pd.read_csv(PATH2)

# eliminate the columns in which we are not interested
df = df.loc[:, df.columns.intersection(['Date', 'Primary Type'])]
df['Date'] = pd.to_datetime(df['Date'], format='%m/%d/%Y %I:%M:%S %p')

crimes_info = df.groupby(by='Primary Type', as_index=False)['Date'].count().sort_values(by='Date',ascending=True)
crimes_info = pd.DataFrame(crimes_info)
crimes_info = crimes_info.rename(columns={'Primary Type':'Crime', 'Date':'Count'})
plt.figure(figsize=(15,6))
chart = sns.barplot(x ='Count', y='Crime', data=crimes_info,
                 palette="Blues_d")
chart.set_yticklabels(chart.get_yticklabels(), fontsize=8)
plt.show()
# crimes_info['Count']
#+end_src

#+RESULTS:
:results:
# Out[47]:
[[file:./obipy-resources/MaJJx2.svg]]
:end:

* Third activity

Here we wish to analise some data about te Covid-19 pandemic.
#+begin_src ipython :session mysession :exports both :results raw drawer
%config InlineBackend.figure_format = 'svg'

PATH3 = '~/Downloads/country_vaccinations.csv'
df_2 = pd.read_csv(PATH3)

# filter by contents of the 'country' column
df_2 = df_2[
    (df_2['country'] == 'Colombia')
    | (df_2['country'] == 'Brazil')
    | (df_2['country'] == 'Chile')
    | (df_2['country'] == 'Argentina')
    | (df_2['country'] == 'Peru')
    | (df_2['country'] == 'Mexico')
    | (df_2['country'] == 'Venezuela')
       ]

df_2 = df_2[['country', 'date', 'total_vaccinations']]
df_2['date'] = pd.to_datetime(df_2['date'], format='%Y-%m-%d')
df_info = pd.DataFrame(df_2.groupby(by='country', as_index=False)['total_vaccinations'].max())
print(df_info)

# plt.figure(figsize=(6,10))
plt.figure()
chart = sns.barplot(x='country', y='total_vaccinations', data=df_info,
                    palette="Blues_d")
plt.show()
# df_info
#+end_src

#+RESULTS:
:results:
# Out[49]:
[[file:./obipy-resources/eaAarC.svg]]
:end:
